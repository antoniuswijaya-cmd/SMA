---
title: "Latihan"
author: "Antonius Aditya Rizky Wijaya"
date: "2025-09-23"
output: word_document
---

Selain pembangkit kongruen kuadratik (PKK) yang telah dibahas pada Praktikum ke-5, terdapat pembangkit kongruen taklinear yang lain, yaitu pembangkit kongruen invers (PKI) yang merupakan suatu rumus rekursif dalam bentuk:

$$ x_{n+1} =
\begin{cases}
(ax_n^{-1}+c) mod~m, & x_n \geq 1 \\
c, & x_n=0
\end{cases} $$

$n=0,1,2,...$

dengan x_0, a, c, dan m adalah bilangan-bilangan bulat taknegatif yang diberikan dan x_n\^(-1) adalah invers dari x_n dengan rumus $$x_n^{-1}(x_n) ≡ 1(mod~m)$$ untuk semua n= 0, 1, 2,...

##a Buat sebuah fungsi di R yang bernama PKI dengan input x_0, a, c, m, dan n yang menghasilkan n buah bilangan pertama yang diperoleh dari suatu pembangkit kongruen invers.

```{r}
PKI <- function(x0, a, c, m, n) {
  bilangan <- numeric(n)
  bilangan[1] <- x0
  for (i in 2:n) {
    if (bilangan[i-1] >= 1) {
      inv <- which((bilangan[i-1] * (1:(m-1))) %% m == 1)
      bilangan[i] <- (a * inv + c) %% m
    } else {
      bilangan[i] <- c
    }
  }
  return(bilangan)
}
```

##b Bangkitkan 512 buah bilangan pertama jika x_0 = 17, a = 9, c = 6, dan m = 1024.

```{r}
set.seed(1)
bilangan <- PKI(x0 = 17, a = 9, c = 6, m = 1024, n = 512);bilangan
```

##c Dengan menggunakan 256 bilangan yang diambil secara acak (tanpa pengembalian) dari 512 bilangan yang telah dibangkitkan pada bagian (b), bangkitkan 128 pasangan terurut (x,y) yang merupakan realisasi dari sebaran bivariate uniform pada (0, 1) × (0, 1) dengan menggunakan set.seed(1).

```{r}
set.seed(1)
x <- bilangan[1:255]/1024
y <- bilangan[2:256]/1024
tabel <- data.frame(x,y)
print(tabel)
plot(tabel)
abline(h=0.5,v=0.5,col="black")
```

##d Lakukan uji kedimensionalan dua dimensi pada 128 pasangan terurut yang telah dibangkitkan pada bagian (c).

```{r}
koor1 <- 0
koor2 <- 0
koor3 <- 0
koor4 <- 0

for (i in 1:length(x)){
  if (x[i] > 0.5 && y[i] > 0.5) koor1 <- koor1 + 1
  if (x[i] > 0.5 && y[i] < 0.5) koor2 <- koor2 + 1
  if (x[i] < 0.5 && y[i] > 0.5) koor3 <- koor3 + 1
  if (x[i] < 0.5 && y[i] < 0.5) koor4 <- koor4 + 1
}
tabel_koor <- data.frame(Koordinat = c("I", "II", "III", "IV"), Frekuensi = c(koor1, koor2, koor3, koor4)); tabel_koor
```

```{r}
n <- length(x)
o_i <- tabel_koor$Frekuensi
pi_i <- rep(0.25, 4)
e_i <- n * pi_i

diskrepansi <- sum((o_i - e_i)^2 / e_i)
p_value <- 1 - pchisq(diskrepansi, df = length(o_i) - 1)
cat("Diskrepansi:", diskrepansi, "\n")
cat("P-value:", p_value, "\n")
```

p_value = 0.5555 \> 0.1, sehingga tidak ada bukti untuk menolak $H_0$. Artinya kita mungkin percaya bahwa pasangan terurut (x,y) yang dihasilkan oleh PKI berdistribusi uniform pada (0,1) x (0,1).
